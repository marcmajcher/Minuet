(this.webpackJsonpminuet=this.webpackJsonpminuet||[]).push([[0],{13:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(5),c=n.n(s),r=(n(13),n(2)),i=n(4),u=n(3);function l(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=0,o=0;o<n;o++)a+=Math.random()*(t-e)+e;return a}var d={available_biomass:{amount:0,decay:.5,generate_min:60,generate_max:90},cool_explore:{type:"cooldown",max:12,seconds:0},msg_explore:{active:!0,count:0,messages:[{after:1,chance:1,text:"msg_explore_1"},{after:3,chance:1,text:"msg_explore_2"},{after:9,chance:.25,text:"msg_explore_3"},{after:10,chance:.25,text:"msg_explore_4"}]}},b=Object(u.b)({name:"data",initialState:d,reducers:{resetGame:function(e){console.log("TK reset game data")},warmCooldowns:function(e,t){var n=t.payload;Object.entries(e).forEach((function(t){var a=Object(i.a)(t,2),o=a[0],s=a[1],c=n/1e3;"cooldown"===s.type&&s.seconds>0&&(e[o].seconds=Math.max(s.seconds-c,0))}))},startCooldown:function(e,t){var n=t.payload;e[n].seconds=e[n].max},addColonistBiomass:function(e,t){var n=t.payload;e.available_biomass.amount+=l(e.available_biomass.generate_min,e.available_biomass.generate_max,n||1)},decayBiomass:function(e){e.available_biomass.amount-=e.available_biomass.amount*e.available_biomass.decay},shiftActionMessage:function(e,t){var n=t.payload;e[n].active&&(e[n].messages.splice(0,1),e[n].messages.length<1&&(e[n].active=!1))},incrementActionMessage:function(e,t){e[t.payload].count+=1}}}),m=b.actions,f=m.warmCooldowns,j=m.startCooldown,p=m.addColonistBiomass,g=m.decayBiomass,x=m.shiftActionMessage,_=m.incrementActionMessage,v=b.reducer,O={stability:{id:1,name:"res_stability",amount:100,rate:-1.67,max:100,type:"common",state:"hidden"},xp:{id:3,name:"res_experience",amount:0,rate:0,max:60,type:"res_common",state:"hidden"},biomass:{id:4,name:"res_biomass",amount:0,rate:0,max:200,type:"common",state:"hidden"},egregore:{id:20,name:"res_egregore",amount:0,rate:0,max:Number.MAX_VALUE,type:"persistent",state:"hidden"}},h=Object(u.b)({name:"resources",initialState:O,reducers:{updateAllResources:function(e,t){var n=t.payload/1e3;Object.entries(e).forEach((function(t){var a=Object(i.a)(t,2),o=a[0],s=a[1];if(0!==s.rate){var c=Math.max(e[o].amount+s.rate*n,0);e[o].amount=Math.min(c,e[o].max)}}))},addResource:function(e,t){var n=t.payload,a=n.resource,o=n.amount;e[a].amount+=o},setResourceRate:function(e,t){var n=t.payload,a=n.resource,o=n.rate;e[a].rate=o},showResource:function(e,t){e[t.payload].state="active"},setDefaultResources:function(e){Object.entries(O).forEach((function(t){var n=Object(i.a)(t,2),a=n[0],o=n[1];e[a]=o}))}}}),y=h.actions,w=y.updateAllResources,S=(y.setResourceRate,y.setDefaultResources),E=y.showResource,M=y.addResource,R=h.reducer,k={btn_clear:"Clear",btn_decant:"Decant",btn_explore:"Explore",btn_save:"Save",msg_no_resources:"[RESOURCES UNAVAILABLE]",msg_log_start:"[LOG] Begin Messages",msg_decant:"[SYS] colonist {colonist} released from cryosleep :: instability {stability}",msg_colonist_expired:"[SYS] colonist {colonist} expired :: unviable",msg_biomass_discover:"You come across a pile of unrecognizable biological goo. Gross, but possibly useful.",msg_wire_discover:"You find an open panel, rip out the wiring, and stow it away someplace safe.",msg_scrap_discover:"You stumble upon some scrap metal. This junk may come in handy later.",msg_explore_1:"You are surrounded by endless hallways and catwalks around a vast chamber filled with frosted glass capsules.",msg_explore_2:"You become weaker and weaker as you feel your body collapsing in on itself.",msg_explore_3:"Something tickles at the back of your mind, as if you've been here before...",msg_explore_4:"You discover a disused storage closet. Maybe you can stash a few things there, in case you don't make it...",res_stability:"Stability",res_experience:"Experience",res_biomass:"Biomass",res_wire:"Wire",res_scrap:"Scrap",res_egregore:"Egregore"};var N=k,A={debug:!1,fps:5,logEntries:[N.msg_log_start],paused:!0,frozen:!0,decants:0,colonistId:-1},C=Object(u.b)({name:"game",initialState:A,reducers:{pause:function(e){e.paused=!0},unpause:function(e){e.paused=!1},debug:function(e,t){e.debug=t.payload},setFPS:function(e,t){e.fps=t.payload},freeze:function(e){e.paused=!0,e.frozen=!0},start:function(e){e.paused=!1,e.frozen=!1},log:function(e,t){var n,a=t.payload;n="object"===typeof a?function(e){var t=k[e.template];for(var n in e)t=t.replace("{".concat(n,"}"),e[n]);return t}(a):N[a]?N[a]:a,e.logEntries.push(n),console.log("[LOG]",n)},decant:function(e){e.paused=!1,e.frozen=!1,e.decants+=1},setColonistId:function(e,t){var n=t.payload;e.colonistId=n}}}),I=C.actions,z=I.pause,B=I.unpause,Y=(I.debug,I.setFPS,I.freeze),L=(I.start,I.log),G=I.decant,D=I.setColonistId,F=C.reducer;function U(){var e=Object(r.b)(),t=function(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.game.colonistId}));return function(n){n.stability.amount<=0&&(e(Y()),e(L({template:"msg_colonist_expired",colonist:t})),e(p()),e(g()))}}(),n=Object(r.c)((function(e){return e.resources})),o=Object(r.c)((function(e){return e.game.paused})),s=Object(r.c)((function(e){return e.game.fps})),c=s>0?1e3/s:Number.MAX_VALUE,i=Object(a.useRef)((function(){e(w(c)),e(f(c))}));Object(a.useEffect)((function(){if(s>0&&!o){var e=setInterval((function(){i.current(c),t(n)}),c);return function(){return clearInterval(e)}}}),[s,c,o,n])}var V=n(1);function H(e){var t=e.resource,n=t.name,a=t.amount,o=t.rate,s=t.max,c=t.type,r=t.state;return Object(V.jsxs)("div",{className:"resource ".concat(r," ").concat(c),children:[Object(V.jsxs)("strong",{children:[N[n],":"]})," ",a.toFixed(2),"/",s," ",0!==o?"(".concat(o.toFixed(2),"/sec)"):""]})}function J(){var e=Object(r.c)((function(e){return e.game.decants})),t=Object(r.c)((function(e){return Object.values(e.resources)}));return Object(V.jsx)("div",{className:"resource-list",children:e>0?t.map((function(e){return Object(V.jsx)(H,{resource:e},e.id)})):N.msg_no_resources})}function P(){var e=Object(r.c)((function(e){return e.game.logEntries}));return Object(V.jsx)("div",{className:"log-entries",children:e&&e.slice().reverse().map((function(e){return Object(V.jsx)("p",{children:e},Math.random())}))})}function T(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.resources.stability.rate})),n=Date.now().toString().substr(-8);return Object(V.jsx)("button",{className:"button-primary",onClick:function(){e(S()),e(G()),e(E("stability")),e(D(n)),e(L({template:"msg_decant",colonist:n,stability:t<0?"HIGH":"none"}))},children:N.btn_decant})}function X(e){var t=e.cooldown,n=e.cool_id,a=e.label_id,o=e.callback,s=Object(r.b)();return Object(V.jsxs)("div",{className:"btn-cooldown",children:[Object(V.jsx)("div",{className:"btn-cooldown-bar",style:{width:"".concat(t.seconds/t.max*100,"%")}}),Object(V.jsxs)("button",{className:"cooldown",disabled:t.seconds>0,onClick:function(){s(j(n)),o()},children:[N[a]," : ",Math.ceil(t.seconds)]})]})}function K(){var e=Object(r.c)((function(e){return e.data.cool_explore})),t=Object(r.c)((function(e){return e.resources.xp})),n=Object(r.b)(),a=function(e){var t=Object(r.b)(),n=Object(r.c)((function(t){return t.data[e]}));return function(){if(n.active){var a=n.messages[0];n.count>=a.after&&Math.random()<a.chance&&(t(L(a.text)),t(x(e))),t(_(e))}}}("msg_explore");return Object(V.jsx)(X,{cooldown:e,cool_id:"cool_explore",label_id:"btn_explore",callback:function(){n(M({resource:"xp",amount:1})),a(),"hidden"===t.state&&n(E("xp"))}})}function W(){var e=Object(r.c)((function(e){return e.game.frozen}));return Object(V.jsx)("div",{className:"action-panel",children:e?Object(V.jsx)(T,{}):Object(V.jsx)(K,{})})}function q(){return Object(V.jsxs)("div",{className:"main-page",children:[Object(V.jsx)(J,{}),Object(V.jsx)(W,{}),Object(V.jsx)(P,{})]})}var Q=n.p+"static/media/orbital.391d4365.svg";function Z(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.game.paused})),n=Object(r.c)((function(e){return e.game.frozen}));return Object(V.jsxs)("header",{children:[Object(V.jsx)("h1",{children:"minuet"}),Object(V.jsx)("img",{className:t?"orbit":"orbit spin",src:Q,alt:"orbit logo",onClick:t&&!n?function(){return e(B())}:function(){return e(z())}})]})}function $(){return Object(V.jsxs)("footer",{children:[Object(V.jsx)("button",{children:N.btn_save})," ",Object(V.jsx)("button",{children:N.btn_clear})]})}var ee=function(){return U(),Object(V.jsxs)("div",{className:"container",children:[Object(V.jsx)(Z,{}),Object(V.jsx)(q,{}),Object(V.jsx)($,{})]})},te=Object(u.a)({reducer:{resources:R,game:F,data:v}});c.a.render(Object(V.jsx)(o.a.StrictMode,{children:Object(V.jsx)(r.a,{store:te,children:Object(V.jsx)(ee,{})})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.4032b8e5.chunk.js.map