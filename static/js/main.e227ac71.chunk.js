(this.webpackJsonpminuet=this.webpackJsonpminuet||[]).push([[0],{13:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(5),r=a.n(s),c=(a(13),a(2)),i=a(4),u=a(3);function l(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=0,o=0;o<a;o++)n+=Math.random()*(t-e)+e;return n}var d={available_biomass:{amount:0,decay:.5,generate_min:60,generate_max:90},cool_explore:{type:"cooldown",max:12,seconds:0,count:0,dropAt:3},droptable_explore:{drop_biomass:.25,drop_wire:.15,drop_scrap:.15},drop_biomass:{resource:"biomass",description:"desc_biomass",first:"msg_biomass_discover",min:5,max:20,limit:"available_biomass"},drop_wire:{resource:"wire",description:"desc_wire",first:"msg_wire_discover",min:1,max:4},drop_scrap:{resource:"scrap",description:"desc_scrap",first:"msg_scrap_discover",min:2,max:10},msg_explore:{active:!0,count:0,messages:[{after:1,chance:1,text:"msg_explore_1"},{after:3,chance:1,text:"msg_explore_2"},{after:9,chance:.25,text:"msg_explore_3"},{after:10,chance:.25,text:"msg_explore_4"}]}},m=Object(u.b)({name:"data",initialState:d,reducers:{warmCooldowns:function(e,t){var a=t.payload/1e3;Object.entries(e).forEach((function(t){var n=Object(i.a)(t,2),o=n[0],s=n[1];"cooldown"===s.type&&s.seconds>0&&(e[o].seconds=Math.max(s.seconds-a,0))}))},startCooldown:function(e,t){var a=t.payload;e[a].seconds=e[a].max,e[a].count+=1},resetCooldowns:function(e){Object.keys(e).forEach((function(t){e[t].seconds=0}))},addColonistBiomass:function(e,t){var a=t.payload;e.available_biomass.amount+=l(e.available_biomass.generate_min,e.available_biomass.generate_max,a||1)},decayBiomass:function(e){e.available_biomass.amount-=e.available_biomass.amount*e.available_biomass.decay},shiftActionMessage:function(e,t){var a=t.payload;e[a].active&&(e[a].messages.splice(0,1),e[a].messages.length<1&&(e[a].active=!1))},incrementActionMessage:function(e,t){e[t.payload].count+=1},removeFirstResourceMessage:function(e,t){delete e[t.payload].first}}}),b=m.actions,f=b.warmCooldowns,p=b.startCooldown,j=b.resetCooldowns,_=b.addColonistBiomass,g=b.decayBiomass,v=b.shiftActionMessage,x=b.incrementActionMessage,h=b.removeFirstResourceMessage,O=m.reducer,y={stability:{id:1,name:"res_stability",amount:100,rate:-1.67,max:100,type:"common",state:"hidden"},xp:{id:3,name:"res_experience",amount:0,rate:0,max:60,type:"res_common",state:"hidden"},biomass:{id:4,name:"res_biomass",amount:0,rate:0,max:200,type:"common",state:"hidden"},wire:{id:5,name:"res_wire",amount:0,rate:0,max:50,type:"common",state:"hidden"},scrap:{id:6,name:"res_scrap",amount:0,rate:0,max:50,type:"common",state:"hidden"},egregore:{id:20,name:"res_egregore",amount:0,rate:0,max:Number.MAX_VALUE,type:"persistent",state:"hidden"}},w=Object(u.b)({name:"resources",initialState:y,reducers:{updateAllResources:function(e,t){var a=t.payload/1e3;Object.entries(e).forEach((function(t){var n=Object(i.a)(t,2),o=n[0],s=n[1];if(0!==s.rate){var r=Math.max(e[o].amount+s.rate*a,0);e[o].amount=Math.min(r,e[o].max)}}))},addResource:function(e,t){var a=t.payload,n=a.resource,o=a.amount,s=e[n].amount+o;e[n].amount=Math.min(s,e[n].max),e[n].state="active"},setResourceRate:function(e,t){var a=t.payload,n=a.resource,o=a.rate;e[n].rate=o},showResource:function(e,t){e[t.payload].state="active"},setDefaultResources:function(e){Object.entries(y).forEach((function(t){var a=Object(i.a)(t,2),n=a[0],o=a[1];e[n]=o}))}}}),M=w.actions,E=M.updateAllResources,R=(M.setResourceRate,M.setDefaultResources),S=M.showResource,k=M.addResource,A=w.reducer,C={and:"and",you_find:"You find {items}",btn_clear:"Clear",btn_decant:"Decant",btn_explore:"Explore",btn_save:"Save",desc_biomass:"some unrecognizable biological material",desc_wire:"a length of scaveneged wire",desc_scrap:"a few pieces of scrap metal",msg_no_resources:"[RESOURCES UNAVAILABLE]",msg_log_start:"[LOG] Begin Messages",msg_decant:"[SYS] colonist {colonist} released from cryosleep :: instability {stability}",msg_colonist_expired:"[SYS] colonist {colonist} expired :: unviable",msg_biomass_discover:"You come across a pile of unrecognizable biological goo. Gross, but possibly useful.",msg_wire_discover:"You find an open panel, rip out the wiring, and stow it away someplace safe.",msg_scrap_discover:"You stumble upon some scrap metal. This junk may come in handy later.",msg_explore_1:"You are surrounded by endless hallways and catwalks around a vast chamber filled with frosted glass capsules.",msg_explore_2:"You become weaker and weaker as you feel your body collapsing in on itself.",msg_explore_3:"Something tickles at the back of your mind, as if you've been here before...",msg_explore_4:"You discover a disused storage closet. Maybe you can stash a few things there, in case you don't make it...",res_stability:"Stability",res_experience:"Experience",res_biomass:"Biomass",res_wire:"Wire",res_scrap:"Scrap",res_egregore:"Egregore"};var N=C,z={debug:!1,fps:5,logEntries:[N.msg_log_start],paused:!0,frozen:!0,decants:0,colonistId:-1},I=Object(u.b)({name:"game",initialState:z,reducers:{pause:function(e){e.paused=!0},unpause:function(e){e.paused=!1},debug:function(e,t){e.debug=t.payload},setFPS:function(e,t){e.fps=t.payload},freeze:function(e){e.paused=!0,e.frozen=!0},start:function(e){e.paused=!1,e.frozen=!1},log:function(e,t){var a,n=t.payload;(a="object"===typeof n?function(e){var t=C[e.template];for(var a in e)t=t.replace("{".concat(a,"}"),e[a]);return t}(n):N[n]?N[n]:n)&&e.logEntries.push(a)},decant:function(e){e.paused=!1,e.frozen=!1,e.decants+=1},setColonistId:function(e,t){var a=t.payload;e.colonistId=a}}}),Y=I.actions,B=Y.pause,F=Y.unpause,L=(Y.debug,Y.setFPS,Y.freeze),D=(Y.start,Y.log),U=Y.decant,G=Y.setColonistId,V=I.reducer;function H(){var e=Object(c.b)(),t=function(){var e=Object(c.b)(),t=Object(c.c)((function(e){return e.game.colonistId}));return function(a){a.stability.amount<=0&&(e(L()),e(D({template:"msg_colonist_expired",colonist:t})),e(_()),e(g()))}}(),a=Object(c.c)((function(e){return e.resources})),o=Object(c.c)((function(e){return e.game.paused})),s=Object(c.c)((function(e){return e.game.fps})),r=s>0?1e3/s:Number.MAX_VALUE,i=Object(n.useRef)((function(){e(E(r)),e(f(r))}));Object(n.useEffect)((function(){if(s>0&&!o){var e=setInterval((function(){i.current(r),t(a)}),r);return function(){return clearInterval(e)}}}),[s,r,o,a])}var J=a(1);function P(e){var t=e.resource,a=t.name,n=t.amount,o=t.rate,s=t.max,r=t.type,c=t.state;return Object(J.jsxs)("div",{className:"resource ".concat(c," ").concat(r),children:[Object(J.jsxs)("strong",{children:[N[a],":"]})," ",n.toFixed(2),"/",s," ",0!==o?"(".concat(o.toFixed(2),"/sec)"):""]})}function X(){var e=Object(c.c)((function(e){return e.game.decants})),t=Object(c.c)((function(e){return Object.values(e.resources)}));return Object(J.jsx)("div",{className:"resource-list",children:e>0?t.map((function(e){return Object(J.jsx)(P,{resource:e},e.id)})):N.msg_no_resources})}function T(){var e=Object(c.c)((function(e){return e.game.logEntries}));return Object(J.jsx)("div",{className:"log-entries",children:e&&e.slice().reverse().map((function(e){return Object(J.jsx)("p",{children:e},Math.random())}))})}function W(){var e=Object(c.b)(),t=Object(c.c)((function(e){return e.resources.stability.rate})),a=Date.now().toString().substr(-8);return Object(J.jsx)("button",{className:"button-primary",onClick:function(){e(R()),e(j()),e(U()),e(S("stability")),e(G(a)),e(D({template:"msg_decant",colonist:a,stability:t<0?"HIGH":"none"}))},children:N.btn_decant})}function q(e){var t=e.cooldown,a=e.cool_id,n=e.label_id,o=e.callback,s=Object(c.b)();return Object(J.jsxs)("div",{className:"btn-cooldown",children:[Object(J.jsx)("div",{className:"btn-cooldown-bar",style:{width:"".concat(t.seconds/t.max*100,"%")}}),Object(J.jsxs)("button",{className:"cooldown",disabled:t.seconds>0,onClick:function(){s(p(a)),o()},children:[N[n]," : ",Math.ceil(t.seconds)]})]})}function K(){var e=Object(c.c)((function(e){return e.data.cool_explore})),t=Object(c.c)((function(e){return e.resources.xp})),a=Object(c.b)(),n=function(e){var t=Object(c.b)(),a=Object(c.c)((function(t){return t.data[e]}));return function(){if(a.active){var n=a.messages[0];a.count>=n.after&&Math.random()<n.chance&&(t(D(n.text)),t(v(e))),t(x(e))}}}("msg_explore"),o=function(e){var t=Object(c.b)(),a=Object(c.c)((function(t){return t.data[e]})),n=Object(c.c)((function(e){return e.data}));return function(){var e=[];for(var o in a)if(Math.random()<a[o]){var s=n[o];if(s.limit&&n[s.limit].amount<=0)continue;s.first?(t(D(s.first)),t(h(o))):e.push(s.description);var r=l(s.min,s.max);s.limit&&(r=Math.min(r,n[s.limit].amount)),t(k({resource:s.resource,amount:r}))}return e}}("droptable_explore");function s(e){var t=e.map((function(e){return N[e]}));switch(t.length){case 0:return"";case 1:return t[0];case 2:return"".concat(t[0]," ").concat(N.and," ").concat(t[1]);default:return t[t.length-1]="".concat(N.and," ").concat(t[t.length-1]),t.join(", ")}}return Object(J.jsx)(q,{cooldown:e,cool_id:"cool_explore",label_id:"btn_explore",callback:function(){if(e.count>=e.dropAt){var r=o();r.length>0&&a(D({template:"you_find",items:s(r)}))}a(k({resource:"xp",amount:1})),"hidden"===t.state&&a(S("xp")),n()}})}function Q(){var e=Object(c.c)((function(e){return e.game.frozen}));return Object(J.jsx)("div",{className:"action-panel",children:e?Object(J.jsx)(W,{}):Object(J.jsx)(K,{})})}function Z(){return Object(J.jsxs)("div",{className:"main-page",children:[Object(J.jsx)(X,{}),Object(J.jsx)(Q,{}),Object(J.jsx)(T,{})]})}var $=a.p+"static/media/orbital.391d4365.svg";function ee(){var e=Object(c.b)(),t=Object(c.c)((function(e){return e.game.paused})),a=Object(c.c)((function(e){return e.game.frozen}));return Object(J.jsxs)("header",{children:[Object(J.jsx)("h1",{children:"minuet"}),Object(J.jsx)("img",{className:t?"orbit":"orbit spin",src:$,alt:"orbit logo",onClick:t&&!a?function(){return e(F())}:function(){return e(B())}})]})}function te(){return Object(J.jsxs)("footer",{children:[Object(J.jsx)("button",{children:N.btn_save})," ",Object(J.jsx)("button",{children:N.btn_clear})]})}var ae=function(){return H(),Object(J.jsxs)("div",{className:"container",children:[Object(J.jsx)(ee,{}),Object(J.jsx)(Z,{}),Object(J.jsx)(te,{})]})},ne=Object(u.a)({reducer:{resources:A,game:V,data:O}});r.a.render(Object(J.jsx)(o.a.StrictMode,{children:Object(J.jsx)(c.a,{store:ne,children:Object(J.jsx)(ae,{})})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.e227ac71.chunk.js.map